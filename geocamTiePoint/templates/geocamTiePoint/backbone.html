{% extends "base.html" %}

{% block head %}
{{ block.super }}
<title>MapFasten</title>
<meta name="viewport" content="initial-scale=1.0, user-scalable=no">
{% endblock %}

{% block style %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}external/css/bootstrap.min.css"></link>
<link rel="stylesheet" type="text/css" href="/static/mapFasten/css/base.css"></link>
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}geocamTiePoint/css/backbone.css"></link>
{% endblock style %}

{% block scripts %}
{{ block.super }}
<script type="text/javascript">
// this line needs to be here otherwise views.js won't get it
window.csrf_token = "{% csrf_token %}";
</script>
<script type="text/javascript" src="/static/external/js/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?v=3.10&sensor=true&libraries=places"></script>

<script type="text/javascript" src="/static/external/js/markerwithlabel_2.js"></script>
<script type="text/javascript" src="/static/external/js/handlebars-1.0.0.beta.6.js"></script>
<script type="text/javascript" src="/static/external/js/underscore-min.js"></script>
<script type="text/javascript" src="/static/external/js/splitter.js"></script>
<script type="text/javascript" src="/static/external/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/static/external/js/matrix.js"></script>
<script type="text/javascript" src="/static/external/js/ExtDraggableObject.js"></script>

<script type="text/javascript" src="/static/geocamTiePoint/js/util.js"></script>
<script type="text/javascript" src="/static/geocamTiePoint/js/undo.js"></script>
<script type="text/javascript" src="/static/geocamTiePoint/js/coords.js"></script>
<script type="text/javascript" src="/static/geocamTiePoint/js/optimize.js"></script>
<script type="text/javascript" src="/static/geocamTiePoint/js/transform.js"></script>
<script type="text/javascript" src="/static/geocamTiePoint/js/maputils.js"></script>

<script type="text/javascript" src="/static/external/js/backbone.js"></script>
<script type="text/javascript" src="/static/geocamTiePoint/js/backbone/models.js"></script>
<script type="text/javascript" src="/static/geocamTiePoint/js/backbone/views.js"></script>
<script type="text/javascript" src="/static/geocamTiePoint/js/backbone/router.js"></script>

    <script type="text/javascript">
        window.settings = {{settings|safe}};

        $(function($){

            app.overlays = app.overlays || new app.models.OverlayCollection;
            {% if initial_overlays_json %}
            // Seed app.overlays with initally loaded data
            var overlay_bootstrap = {{ initial_overlays_json|safe }};
            app.overlays.reset(overlay_bootstrap);
            {% endif %}

            app.navbar = new app.views.NavbarView({el: $('#navbar').addClass('navbar')});
            app.navbar.render();

            app.router.start(); // initializes the app view based on url fragment.
        });
    </script>

{% endblock scripts %}

{% block header %}
{%comment%}{{block.super}}{%endcomment%}
<div id="navbar" class="navbar"></div>
{% endblock header %}

{% block contents %}
<div id='backbone_app_container'>
</div>
{% endblock contents %}

{% block jsInit %}
{{ block.super }}
$(
);
{% endblock jsInit %}
